<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }}</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', 'SimHei', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: white;
            box-shadow: 0 0 30px rgba(0,0,0,0.2);
            border-radius: 15px;
            margin-top: 20px;
            margin-bottom: 20px;
        }
        
        .header {
            text-align: center;
            padding: 40px 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px 15px 0 0;
            margin: -20px -20px 40px -20px;
        }
        
        .header h1 {
            font-size: 2.8em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .header .subtitle {
            font-size: 1.3em;
            opacity: 0.9;
            margin-bottom: 20px;
        }
        
        .header .badge {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            padding: 8px 20px;
            border-radius: 25px;
            font-size: 1em;
            font-weight: bold;
        }
        
        .metadata {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .metadata-item {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid #dee2e6;
        }
        
        .metadata-item .label {
            font-size: 0.9em;
            color: #6c757d;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .metadata-item .value {
            font-size: 1.2em;
            font-weight: bold;
            color: #495057;
        }
        
        .summary-section {
            margin: 40px 0;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 15px;
            border-left: 5px solid #007bff;
        }
        
        .summary-section h2 {
            color: #007bff;
            font-size: 2em;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }
        
        .summary-section h2:before {
            content: "üìä";
            margin-right: 15px;
            font-size: 1.2em;
        }
        
        .key-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }
        
        .metric-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
            border: 1px solid #e9ecef;
        }
        
        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .metric-card .icon {
            font-size: 3em;
            margin-bottom: 15px;
        }
        
        .metric-card .value {
            font-size: 2.5em;
            font-weight: bold;
            margin: 15px 0;
            color: #007bff;
        }
        
        .metric-card .label {
            font-size: 1.1em;
            color: #6c757d;
            margin-bottom: 10px;
        }
        
        .metric-card .description {
            font-size: 0.9em;
            color: #868e96;
            line-height: 1.4;
        }
        
        .status-indicator {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .status-indicator.excellent {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status-indicator.good {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        .status-indicator.warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        
        .status-indicator.critical {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .highlights {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .highlights h3 {
            color: #495057;
            font-size: 1.5em;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }
        
        .highlights h3:before {
            content: "‚≠ê";
            margin-right: 10px;
        }
        
        .highlight-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .highlight-item {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #28a745;
        }
        
        .highlight-item.warning {
            border-left-color: #ffc107;
        }
        
        .highlight-item.critical {
            border-left-color: #dc3545;
        }
        
        .highlight-item h4 {
            color: #495057;
            margin-bottom: 10px;
            font-size: 1.2em;
        }
        
        .highlight-item p {
            color: #6c757d;
            font-size: 0.95em;
            line-height: 1.5;
        }
        
        .recommendations {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
        }
        
        .recommendations h3 {
            color: #1976d2;
            font-size: 1.6em;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }
        
        .recommendations h3:before {
            content: "üí°";
            margin-right: 10px;
        }
        
        .recommendation-list {
            list-style: none;
        }
        
        .recommendation-list li {
            background: white;
            margin: 15px 0;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-left: 4px solid #1976d2;
            transition: transform 0.2s ease;
        }
        
        .recommendation-list li:hover {
            transform: translateX(5px);
        }
        
        .recommendation-list li:before {
            content: "‚ñ∂";
            color: #1976d2;
            font-weight: bold;
            margin-right: 10px;
        }
        
        .priority {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: bold;
            margin-left: 10px;
        }
        
        .priority.high {
            background: #dc3545;
            color: white;
        }
        
        .priority.medium {
            background: #ffc107;
            color: #212529;
        }
        
        .priority.low {
            background: #28a745;
            color: white;
        }
        
        .chart-section {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .chart-section h3 {
            color: #495057;
            margin-bottom: 20px;
            font-size: 1.5em;
        }
        
        .chart-placeholder {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border: 2px dashed #dee2e6;
            border-radius: 10px;
            padding: 50px;
            margin: 20px 0;
            color: #6c757d;
        }
        
        .footer {
            text-align: center;
            padding: 30px 0;
            border-top: 2px solid #e9ecef;
            margin-top: 50px;
            color: #6c757d;
        }
        
        .footer .signature {
            font-style: italic;
            margin-bottom: 10px;
        }
        
        .footer .timestamp {
            font-size: 0.9em;
            color: #868e96;
        }
        
        @media print {
            body {
                background: white;
            }
            
            .container {
                box-shadow: none;
                max-width: none;
                margin: 0;
                padding: 0;
                border-radius: 0;
            }
            
            .header {
                background: #007bff !important;
                -webkit-print-color-adjust: exact;
                color-adjust: exact;
                border-radius: 0;
                margin: 0 0 40px 0;
            }
            
            .metric-card,
            .highlights,
            .recommendations,
            .chart-section {
                page-break-inside: avoid;
                box-shadow: none;
            }
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 15px;
                margin: 10px;
            }
            
            .header {
                margin: -15px -15px 30px -15px;
                padding: 30px 15px;
            }
            
            .header h1 {
                font-size: 2.2em;
            }
            
            .metadata,
            .key-metrics,
            .highlight-grid {
                grid-template-columns: 1fr;
            }
            
            .metric-card {
                padding: 20px;
            }
            
            .metric-card .value {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Êä•ÂëäÂ§¥ÈÉ® -->
        <div class="header">
            <h1>{{ title }}</h1>
            <div class="subtitle">{{ subtitle or "ÊâßË°åÊëòË¶ÅÊä•Âëä" }}</div>
            <div class="badge">{{ report_type or "EXECUTIVE SUMMARY" }}</div>
        </div>
        
        <!-- Âü∫Êú¨‰ø°ÊÅØ -->
        <div class="metadata">
            <div class="metadata-item">
                <div class="label">È°πÁõÆÁºñÂè∑</div>
                <div class="value">{{ project_id }}</div>
            </div>
            <div class="metadata-item">
                <div class="label">Êä•Âëä‰ΩúËÄÖ</div>
                <div class="value">{{ author }}</div>
            </div>
            <div class="metadata-item">
                <div class="label">ÊâÄÂ±ûÈÉ®Èó®</div>
                <div class="value">{{ department }}</div>
            </div>
            <div class="metadata-item">
                <div class="label">ÁîüÊàêÊó∂Èó¥</div>
                <div class="value">{{ generated_at | format_datetime }}</div>
            </div>
        </div>
        
        <!-- Ê†∏ÂøÉÊåáÊ†á -->
        <div class="summary-section">
            <h2>Ê†∏ÂøÉÊåáÊ†áÊ¶ÇËßà</h2>
            <div class="key-metrics">
                <div class="metric-card">
                    <div class="icon">üéØ</div>
                    <div class="value">{{ (data.overall_score * 100) | round | int if data.overall_score else 87 }}%</div>
                    <div class="label">Êï¥‰ΩìËØÑÂàÜ</div>
                    <div class="status-indicator {{ 'excellent' if (data.overall_score or 0.87) >= 0.9 else 'good' if (data.overall_score or 0.87) >= 0.7 else 'warning' if (data.overall_score or 0.87) >= 0.5 else 'critical' }}">
                        {{ '‰ºòÁßÄ' if (data.overall_score or 0.87) >= 0.9 else 'ËâØÂ•Ω' if (data.overall_score or 0.87) >= 0.7 else 'ÈúÄÊîπËøõ' if (data.overall_score or 0.87) >= 0.5 else '‰∏•Èáç' }}
                    </div>
                    <div class="description">Âü∫‰∫éÂÖ®Èù¢ËØÑ‰º∞ÁöÑÁªºÂêàÂæóÂàÜ</div>
                </div>
                
                <div class="metric-card">
                    <div class="icon">‚ö†Ô∏è</div>
                    <div class="value">{{ data.risk_level or "‰∏≠Á≠â" }}</div>
                    <div class="label">È£éÈô©Á≠âÁ∫ß</div>
                    <div class="status-indicator {{ 'excellent' if (data.risk_level or '‰∏≠Á≠â') == '‰Ωé' else 'warning' if (data.risk_level or '‰∏≠Á≠â') == '‰∏≠Á≠â' else 'critical' }}">
                        {{ data.risk_level or "‰∏≠Á≠â" }}È£éÈô©
                    </div>
                    <div class="description">ÂΩìÂâçÈ°πÁõÆÁöÑÊï¥‰ΩìÈ£éÈô©Ê∞¥Âπ≥</div>
                </div>
                
                <div class="metric-card">
                    <div class="icon">‚úÖ</div>
                    <div class="value">{{ (data.compliance_rate * 100) | round | int if data.compliance_rate else 92 }}%</div>
                    <div class="label">ÂêàËßÑÁéá</div>
                    <div class="status-indicator {{ 'excellent' if (data.compliance_rate or 0.92) >= 0.95 else 'good' if (data.compliance_rate or 0.92) >= 0.8 else 'warning' }}">
                        {{ '‰ºòÁßÄ' if (data.compliance_rate or 0.92) >= 0.95 else 'ËâØÂ•Ω' if (data.compliance_rate or 0.92) >= 0.8 else 'ÈúÄÊîπËøõ' }}
                    </div>
                    <div class="description">Á¨¶ÂêàÊ†áÂáÜË¶ÅÊ±ÇÁöÑÊØî‰æã</div>
                </div>
                
                <div class="metric-card">
                    <div class="icon">üîç</div>
                    <div class="value">{{ data.issues_found or 8 }}</div>
                    <div class="label">ÂèëÁé∞ÈóÆÈ¢ò</div>
                    <div class="status-indicator {{ 'excellent' if (data.issues_found or 8) <= 3 else 'good' if (data.issues_found or 8) <= 8 else 'warning' if (data.issues_found or 8) <= 15 else 'critical' }}">
                        {{ 'ÂæàÂ∞ë' if (data.issues_found or 8) <= 3 else 'ÈÄÇ‰∏≠' if (data.issues_found or 8) <= 8 else 'ËæÉÂ§ö' if (data.issues_found or 8) <= 15 else 'ÂæàÂ§ö' }}
                    </div>
                    <div class="description">ÈúÄË¶ÅÂÖ≥Ê≥®ÂíåËß£ÂÜ≥ÁöÑÈóÆÈ¢òÊï∞Èáè</div>
                </div>
            </div>
        </div>
        
        <!-- ÂÖ≥ÈîÆÂèëÁé∞ -->
        <div class="highlights">
            <h3>ÂÖ≥ÈîÆÂèëÁé∞</h3>
            <div class="highlight-grid">
                {% if data.key_findings %}
                    {% for finding in data.key_findings[:6] %}
                    <div class="highlight-item {{ finding.severity | lower if finding.severity else '' }}">
                        <h4>{{ finding.title }}</h4>
                        <p>{{ finding.description }}</p>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="highlight-item">
                        <h4>Á≥ªÁªüÊû∂ÊûÑËØÑ‰º∞</h4>
                        <p>Êï¥‰ΩìÊû∂ÊûÑËÆæËÆ°ÂêàÁêÜÔºåÊ®°ÂùóÂåñÁ®ãÂ∫¶ËæÉÈ´òÔºå‰ΩÜÂú®Êüê‰∫õÂÖ≥ÈîÆÁªÑ‰ª∂ÁöÑÂÆπÈîôÊÄßÊñπÈù¢ÈúÄË¶ÅÂä†Âº∫„ÄÇ</p>
                    </div>
                    <div class="highlight-item warning">
                        <h4>ÂÆâÂÖ®ÊÄßËØÑ‰º∞</h4>
                        <p>ÂèëÁé∞ÈÉ®ÂàÜÂÆâÂÖ®ÈÖçÁΩÆ‰∏çÂΩìÔºåÂª∫ËÆÆÂä†Âº∫ËÆøÈóÆÊéßÂà∂ÂíåÊï∞ÊçÆÂä†ÂØÜÊé™ÊñΩ„ÄÇ</p>
                    </div>
                    <div class="highlight-item">
                        <h4>ÊÄßËÉΩË°®Áé∞</h4>
                        <p>Á≥ªÁªüÊÄßËÉΩË°®Áé∞ËâØÂ•ΩÔºåÂìçÂ∫îÊó∂Èó¥Âú®ÂèØÊé•ÂèóËåÉÂõ¥ÂÜÖÔºå‰ΩÜÈ´òÂπ∂ÂèëÂú∫ÊôØ‰∏ãÈúÄË¶Å‰ºòÂåñ„ÄÇ</p>
                    </div>
                    <div class="highlight-item critical">
                        <h4>ÂêàËßÑÊÄßÊ£ÄÊü•</h4>
                        <p>ÈÉ®ÂàÜ‰∏öÂä°ÊµÅÁ®ã‰∏çÁ¨¶ÂêàË°å‰∏öÊ†áÂáÜÔºåÈúÄË¶ÅÂèäÊó∂Êï¥Êîπ‰ª•Êª°Ë∂≥ÁõëÁÆ°Ë¶ÅÊ±Ç„ÄÇ</p>
                    </div>
                {% endif %}
            </div>
        </div>
        
        <!-- ÂõæË°®Â±ïÁ§∫ -->
        {% if charts %}
        <div class="chart-section">
            <h3>üìà Êï∞ÊçÆÂèØËßÜÂåñ</h3>
            {% for chart in charts %}
            <div class="chart-placeholder">
                <h4>{{ chart.title }}</h4>
                <p>ÂõæË°®Á±ªÂûã: {{ chart.type }}</p>
                <p>{{ chart.description }}</p>
            </div>
            {% endfor %}
        </div>
        {% endif %}
        
        <!-- ‰∏ªË¶ÅÂª∫ËÆÆ -->
        <div class="recommendations">
            <h3>‰∏ªË¶ÅÂª∫ËÆÆÊé™ÊñΩ</h3>
            <ul class="recommendation-list">
                {% if data.recommendations %}
                    {% for recommendation in data.recommendations %}
                    <li>
                        {{ recommendation.description if recommendation.description else recommendation }}
                        {% if recommendation.priority %}
                        <span class="priority {{ recommendation.priority | lower }}">{{ recommendation.priority }}‰ºòÂÖàÁ∫ß</span>
                        {% endif %}
                    </li>
                    {% endfor %}
                {% else %}
                    <li>
                        Âä†Âº∫Á≥ªÁªüÂÆâÂÖ®ÈÖçÁΩÆÔºåÂÆûÊñΩÂ§öÂ±ÇÈò≤Êä§Êú∫Âà∂
                        <span class="priority high">È´ò‰ºòÂÖàÁ∫ß</span>
                    </li>
                    <li>
                        ‰ºòÂåñÊï∞ÊçÆÂ∫ìÊÄßËÉΩÔºåÂª∫Á´ãÁõëÊéßÂíåÈ¢ÑË≠¶Êú∫Âà∂
                        <span class="priority medium">‰∏≠‰ºòÂÖàÁ∫ß</span>
                    </li>
                    <li>
                        ÂÆåÂñÑ‰∏öÂä°ÊµÅÁ®ãÊñáÊ°£ÔºåÁ°Æ‰øùÂêàËßÑÊÄßË¶ÅÊ±Ç
                        <span class="priority high">È´ò‰ºòÂÖàÁ∫ß</span>
                    </li>
                    <li>
                        Âª∫Á´ãÂÆöÊúüËØÑ‰º∞Êú∫Âà∂ÔºåÊåÅÁª≠ÊîπËøõÁ≥ªÁªüË¥®Èáè
                        <span class="priority medium">‰∏≠‰ºòÂÖàÁ∫ß</span>
                    </li>
                    <li>
                        Âä†Âº∫Âõ¢ÈòüÂüπËÆ≠ÔºåÊèêÂçáÊäÄÊúØËÉΩÂäõÂíåÂÆâÂÖ®ÊÑèËØÜ
                        <span class="priority low">‰Ωé‰ºòÂÖàÁ∫ß</span>
                    </li>
                {% endif %}
            </ul>
        </div>
        
        <!-- È°µËÑö -->
        <div class="footer">
            <div class="signature">Êú¨Êä•ÂëäÁî±Á≥ªÁªüËØÑÂÆ°ÊäÄÊúØÂπ≥Âè∞Êô∫ËÉΩÁîüÊàê</div>
            <div class="timestamp">ÁîüÊàêÊó∂Èó¥: {{ generated_at | format_datetime }}</div>
        </div>
    </div>
</body>
</html>