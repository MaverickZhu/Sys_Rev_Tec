<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }}</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', 'SimHei', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: white;
            box-shadow: 0 0 30px rgba(0,0,0,0.2);
            border-radius: 15px;
            margin-top: 20px;
            margin-bottom: 20px;
        }
        
        .header {
            text-align: center;
            padding: 40px 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px 15px 0 0;
            margin: -20px -20px 40px -20px;
        }
        
        .header h1 {
            font-size: 2.8em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .header .subtitle {
            font-size: 1.3em;
            opacity: 0.9;
            margin-bottom: 20px;
        }
        
        .header .badge {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            padding: 8px 20px;
            border-radius: 25px;
            font-size: 1em;
            font-weight: bold;
        }
        
        .metadata {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .metadata-item {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid #dee2e6;
        }
        
        .metadata-item .label {
            font-size: 0.9em;
            color: #6c757d;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .metadata-item .value {
            font-size: 1.2em;
            font-weight: bold;
            color: #495057;
        }
        
        .summary-section {
            margin: 40px 0;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 15px;
            border-left: 5px solid #007bff;
        }
        
        .summary-section h2 {
            color: #007bff;
            font-size: 2em;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }
        
        .summary-section h2:before {
            content: "ğŸ“Š";
            margin-right: 15px;
            font-size: 1.2em;
        }
        
        .key-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }
        
        .metric-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
            border: 1px solid #e9ecef;
        }
        
        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .metric-card .icon {
            font-size: 3em;
            margin-bottom: 15px;
        }
        
        .metric-card .value {
            font-size: 2.5em;
            font-weight: bold;
            margin: 15px 0;
            color: #007bff;
        }
        
        .metric-card .label {
            font-size: 1.1em;
            color: #6c757d;
            margin-bottom: 10px;
        }
        
        .metric-card .description {
            font-size: 0.9em;
            color: #868e96;
            line-height: 1.4;
        }
        
        .status-indicator {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .status-indicator.excellent {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status-indicator.good {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        .status-indicator.warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        
        .status-indicator.critical {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .highlights {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .highlights h3 {
            color: #495057;
            font-size: 1.5em;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }
        
        .highlights h3:before {
            content: "â­";
            margin-right: 10px;
        }
        
        .highlight-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .highlight-item {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #28a745;
        }
        
        .highlight-item.warning {
            border-left-color: #ffc107;
        }
        
        .highlight-item.critical {
            border-left-color: #dc3545;
        }
        
        .highlight-item h4 {
            color: #495057;
            margin-bottom: 10px;
            font-size: 1.2em;
        }
        
        .highlight-item p {
            color: #6c757d;
            font-size: 0.95em;
            line-height: 1.5;
        }
        
        .recommendations {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
        }
        
        .recommendations h3 {
            color: #1976d2;
            font-size: 1.6em;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }
        
        .recommendations h3:before {
            content: "ğŸ’¡";
            margin-right: 10px;
        }
        
        .recommendation-list {
            list-style: none;
        }
        
        .recommendation-list li {
            background: white;
            margin: 15px 0;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-left: 4px solid #1976d2;
            transition: transform 0.2s ease;
        }
        
        .recommendation-list li:hover {
            transform: translateX(5px);
        }
        
        .recommendation-list li:before {
            content: "â–¶";
            color: #1976d2;
            font-weight: bold;
            margin-right: 10px;
        }
        
        .priority {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: bold;
            margin-left: 10px;
        }
        
        .priority.high {
            background: #dc3545;
            color: white;
        }
        
        .priority.medium {
            background: #ffc107;
            color: #212529;
        }
        
        .priority.low {
            background: #28a745;
            color: white;
        }
        
        .chart-section {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .chart-section h3 {
            color: #495057;
            margin-bottom: 20px;
            font-size: 1.5em;
        }
        
        .chart-placeholder {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border: 2px dashed #dee2e6;
            border-radius: 10px;
            padding: 50px;
            margin: 20px 0;
            color: #6c757d;
        }
        
        .footer {
            text-align: center;
            padding: 30px 0;
            border-top: 2px solid #e9ecef;
            margin-top: 50px;
            color: #6c757d;
        }
        
        .footer .signature {
            font-style: italic;
            margin-bottom: 10px;
        }
        
        .footer .timestamp {
            font-size: 0.9em;
            color: #868e96;
        }
        
        @media print {
            body {
                background: white;
            }
            
            .container {
                box-shadow: none;
                max-width: none;
                margin: 0;
                padding: 0;
                border-radius: 0;
            }
            
            .header {
                background: #007bff !important;
                -webkit-print-color-adjust: exact;
                color-adjust: exact;
                border-radius: 0;
                margin: 0 0 40px 0;
            }
            
            .metric-card,
            .highlights,
            .recommendations,
            .chart-section {
                page-break-inside: avoid;
                box-shadow: none;
            }
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 15px;
                margin: 10px;
            }
            
            .header {
                margin: -15px -15px 30px -15px;
                padding: 30px 15px;
            }
            
            .header h1 {
                font-size: 2.2em;
            }
            
            .metadata,
            .key-metrics,
            .highlight-grid {
                grid-template-columns: 1fr;
            }
            
            .metric-card {
                padding: 20px;
            }
            
            .metric-card .value {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- æŠ¥å‘Šå¤´éƒ¨ -->
        <div class="header">
            <h1>{{ title }}</h1>
            <div class="subtitle">{{ subtitle or "æ‰§è¡Œæ‘˜è¦æŠ¥å‘Š" }}</div>
            <div class="badge">{{ report_type or "EXECUTIVE SUMMARY" }}</div>
        </div>
        
        <!-- åŸºæœ¬ä¿¡æ¯ -->
        <div class="metadata">
            <div class="metadata-item">
                <div class="label">é¡¹ç›®ç¼–å·</div>
                <div class="value">{{ project_id }}</div>
            </div>
            <div class="metadata-item">
                <div class="label">æŠ¥å‘Šä½œè€…</div>
                <div class="value">{{ author }}</div>
            </div>
            <div class="metadata-item">
                <div class="label">æ‰€å±éƒ¨é—¨</div>
                <div class="value">{{ department }}</div>
            </div>
            <div class="metadata-item">
                <div class="label">ç”Ÿæˆæ—¶é—´</div>
                <div class="value">{{ generated_at | format_datetime }}</div>
            </div>
        </div>
        
        <!-- æ ¸å¿ƒæŒ‡æ ‡ -->
        <div class="summary-section">
            <h2>æ ¸å¿ƒæŒ‡æ ‡æ¦‚è§ˆ</h2>
            <div class="key-metrics">
                <div class="metric-card">
                    <div class="icon">ğŸ¯</div>
                    <div class="value">{{ (data.overall_score * 100) | round | int if data.overall_score else 87 }}%</div>
                    <div class="label">æ•´ä½“è¯„åˆ†</div>
                    <div class="status-indicator {{ 'excellent' if (data.overall_score or 0.87) >= 0.9 else 'good' if (data.overall_score or 0.87) >= 0.7 else 'warning' if (data.overall_score or 0.87) >= 0.5 else 'critical' }}">
                        {{ 'ä¼˜ç§€' if (data.overall_score or 0.87) >= 0.9 else 'è‰¯å¥½' if (data.overall_score or 0.87) >= 0.7 else 'éœ€æ”¹è¿›' if (data.overall_score or 0.87) >= 0.5 else 'ä¸¥é‡' }}
                    </div>
                    <div class="description">åŸºäºå…¨é¢è¯„ä¼°çš„ç»¼åˆå¾—åˆ†</div>
                </div>
                
                <div class="metric-card">
                    <div class="icon">âš ï¸</div>
                    <div class="value">{{ data.risk_level or "ä¸­ç­‰" }}</div>
                    <div class="label">é£é™©ç­‰çº§</div>
                    <div class="status-indicator {{ 'excellent' if (data.risk_level or 'ä¸­ç­‰') == 'ä½' else 'warning' if (data.risk_level or 'ä¸­ç­‰') == 'ä¸­ç­‰' else 'critical' }}">
                        {{ data.risk_level or "ä¸­ç­‰" }}é£é™©
                    </div>
                    <div class="description">å½“å‰é¡¹ç›®çš„æ•´ä½“é£é™©æ°´å¹³</div>
                </div>
                
                <div class="metric-card">
                    <div class="icon">âœ…</div>
                    <div class="value">{{ (data.compliance_rate * 100) | round | int if data.compliance_rate else 92 }}%</div>
                    <div class="label">åˆè§„ç‡</div>
                    <div class="status-indicator {{ 'excellent' if (data.compliance_rate or 0.92) >= 0.95 else 'good' if (data.compliance_rate or 0.92) >= 0.8 else 'warning' }}">
                        {{ 'ä¼˜ç§€' if (data.compliance_rate or 0.92) >= 0.95 else 'è‰¯å¥½' if (data.compliance_rate or 0.92) >= 0.8 else 'éœ€æ”¹è¿›' }}
                    </div>
                    <div class="description">ç¬¦åˆæ ‡å‡†è¦æ±‚çš„æ¯”ä¾‹</div>
                </div>
                
                <div class="metric-card">
                    <div class="icon">ğŸ”</div>
                    <div class="value">{{ data.issues_found or 8 }}</div>
                    <div class="label">å‘ç°é—®é¢˜</div>
                    <div class="status-indicator {{ 'excellent' if (data.issues_found or 8) <= 3 else 'good' if (data.issues_found or 8) <= 8 else 'warning' if (data.issues_found or 8) <= 15 else 'critical' }}">
                        {{ 'å¾ˆå°‘' if (data.issues_found or 8) <= 3 else 'é€‚ä¸­' if (data.issues_found or 8) <= 8 else 'è¾ƒå¤š' if (data.issues_found or 8) <= 15 else 'å¾ˆå¤š' }}
                    </div>
                    <div class="description">éœ€è¦å…³æ³¨å’Œè§£å†³çš„é—®é¢˜æ•°é‡</div>
                </div>
            </div>
        </div>
        
        <!-- å…³é”®å‘ç° -->
        <div class="highlights">
            <h3>å…³é”®å‘ç°</h3>
            <div class="highlight-grid">
                {% if data.key_findings %}
                    {% for finding in data.key_findings[:6] %}
                    <div class="highlight-item {{ finding.severity | lower if finding.severity else '' }}">
                        <h4>{{ finding.title }}</h4>
                        <p>{{ finding.description }}</p>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="highlight-item">
                        <h4>ç³»ç»Ÿæ¶æ„è¯„ä¼°</h4>
                        <p>æ•´ä½“æ¶æ„è®¾è®¡åˆç†ï¼Œæ¨¡å—åŒ–ç¨‹åº¦è¾ƒé«˜ï¼Œä½†åœ¨æŸäº›å…³é”®ç»„ä»¶çš„å®¹é”™æ€§æ–¹é¢éœ€è¦åŠ å¼ºã€‚</p>
                    </div>
                    <div class="highlight-item warning">
                        <h4>å®‰å…¨æ€§è¯„ä¼°</h4>
                        <p>å‘ç°éƒ¨åˆ†å®‰å…¨é…ç½®ä¸å½“ï¼Œå»ºè®®åŠ å¼ºè®¿é—®æ§åˆ¶å’Œæ•°æ®åŠ å¯†æªæ–½ã€‚</p>
                    </div>
                    <div class="highlight-item">
                        <h4>æ€§èƒ½è¡¨ç°</h4>
                        <p>ç³»ç»Ÿæ€§èƒ½è¡¨ç°è‰¯å¥½ï¼Œå“åº”æ—¶é—´åœ¨å¯æ¥å—èŒƒå›´å†…ï¼Œä½†é«˜å¹¶å‘åœºæ™¯ä¸‹éœ€è¦ä¼˜åŒ–ã€‚</p>
                    </div>
                    <div class="highlight-item critical">
                        <h4>åˆè§„æ€§æ£€æŸ¥</h4>
                        <p>éƒ¨åˆ†ä¸šåŠ¡æµç¨‹ä¸ç¬¦åˆè¡Œä¸šæ ‡å‡†ï¼Œéœ€è¦åŠæ—¶æ•´æ”¹ä»¥æ»¡è¶³ç›‘ç®¡è¦æ±‚ã€‚</p>
                    </div>
                {% endif %}
            </div>
        </div>
        
        <!-- å›¾è¡¨å±•ç¤º -->
        {% if charts %}
        <div class="chart-section">
            <h3>ğŸ“ˆ æ•°æ®å¯è§†åŒ–</h3>
            {% for chart in charts %}
            <div class="chart-placeholder">
                <h4>{{ chart.title }}</h4>
                <p>å›¾è¡¨ç±»å‹: {{ chart.type }}</p>
                <p>{{ chart.description }}</p>
            </div>
            {% endfor %}
        </div>
        {% endif %}
        
        <!-- ä¸»è¦å»ºè®® -->
        <div class="recommendations">
            <h3>ä¸»è¦å»ºè®®æªæ–½</h3>
            <ul class="recommendation-list">
                {% if data.recommendations %}
                    {% for recommendation in data.recommendations %}
                    <li>
                        {{ recommendation.description if recommendation.description else recommendation }}
                        {% if recommendation.priority %}
                        <span class="priority {{ recommendation.priority | lower }}">{{ recommendation.priority }}ä¼˜å…ˆçº§</span>
                        {% endif %}
                    </li>
                    {% endfor %}
                {% else %}
                    <li>
                        åŠ å¼ºç³»ç»Ÿå®‰å…¨é…ç½®ï¼Œå®æ–½å¤šå±‚é˜²æŠ¤æœºåˆ¶
                        <span class="priority high">é«˜ä¼˜å…ˆçº§</span>
                    </li>
                    <li>
                        ä¼˜åŒ–æ•°æ®åº“æ€§èƒ½ï¼Œå»ºç«‹ç›‘æ§å’Œé¢„è­¦æœºåˆ¶
                        <span class="priority medium">ä¸­ä¼˜å…ˆçº§</span>
                    </li>
                    <li>
                        å®Œå–„ä¸šåŠ¡æµç¨‹æ–‡æ¡£ï¼Œç¡®ä¿åˆè§„æ€§è¦æ±‚
                        <span class="priority high">é«˜ä¼˜å…ˆçº§</span>
                    </li>
                    <li>
                        å»ºç«‹å®šæœŸè¯„ä¼°æœºåˆ¶ï¼ŒæŒç»­æ”¹è¿›ç³»ç»Ÿè´¨é‡
                        <span class="priority medium">ä¸­ä¼˜å…ˆçº§</span>
                    </li>
                    <li>
                        åŠ å¼ºå›¢é˜ŸåŸ¹è®­ï¼Œæå‡æŠ€æœ¯èƒ½åŠ›å’Œå®‰å…¨æ„è¯†
                        <span class="priority low">ä½ä¼˜å…ˆçº§</span>
                    </li>
                {% endif %}
            </ul>
        </div>
        
        <!-- é¡µè„š -->
        <div class="footer">
            <div class="signature">æœ¬æŠ¥å‘Šç”±ç³»ç»Ÿè¯„å®¡æŠ€æœ¯å¹³å°æ™ºèƒ½ç”Ÿæˆ</div>
            <div class="timestamp">ç”Ÿæˆæ—¶é—´: {{ generated_at | format_datetime }}</div>
        </div>
    </div>
</body>
</html>