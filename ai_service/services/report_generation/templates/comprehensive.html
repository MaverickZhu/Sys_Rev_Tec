<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }}</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', 'SimHei', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f8f9fa;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        
        .header {
            text-align: center;
            padding: 40px 0;
            border-bottom: 3px solid #007bff;
            margin-bottom: 40px;
        }
        
        .header h1 {
            font-size: 2.5em;
            color: #007bff;
            margin-bottom: 10px;
        }
        
        .header .subtitle {
            font-size: 1.2em;
            color: #666;
            margin-bottom: 20px;
        }
        
        .metadata {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .metadata-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #007bff;
        }
        
        .metadata-item .label {
            font-weight: bold;
            color: #495057;
            margin-bottom: 5px;
        }
        
        .metadata-item .value {
            color: #007bff;
            font-size: 1.1em;
        }
        
        .toc {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 10px;
            margin: 40px 0;
        }
        
        .toc h2 {
            color: #007bff;
            margin-bottom: 20px;
            font-size: 1.8em;
        }
        
        .toc ul {
            list-style: none;
        }
        
        .toc li {
            margin: 10px 0;
            padding: 10px;
            background: white;
            border-radius: 5px;
            border-left: 4px solid #007bff;
        }
        
        .toc a {
            text-decoration: none;
            color: #007bff;
            font-weight: 500;
            font-size: 1.1em;
        }
        
        .toc a:hover {
            color: #0056b3;
        }
        
        .section {
            margin: 50px 0;
            padding: 30px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .section h2 {
            color: #007bff;
            font-size: 2em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e9ecef;
        }
        
        .section h3 {
            color: #495057;
            font-size: 1.5em;
            margin: 25px 0 15px 0;
        }
        
        .section p {
            margin-bottom: 15px;
            text-align: justify;
            font-size: 1.05em;
        }
        
        .overview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .overview-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
        }
        
        .overview-card h4 {
            font-size: 1.2em;
            margin-bottom: 10px;
        }
        
        .overview-card .value {
            font-size: 2.5em;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .overview-card .description {
            font-size: 0.9em;
            opacity: 0.9;
        }
        
        .risk-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .risk-item {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            transition: transform 0.2s;
        }
        
        .risk-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .risk-level {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .risk-level.high {
            background: #dc3545;
            color: white;
        }
        
        .risk-level.medium {
            background: #ffc107;
            color: #212529;
        }
        
        .risk-level.low {
            background: #28a745;
            color: white;
        }
        
        .compliance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .compliance-item {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
        }
        
        .compliance-status {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .compliance-status.compliant {
            background: #28a745;
            color: white;
        }
        
        .compliance-status.non-compliant {
            background: #dc3545;
            color: white;
        }
        
        .compliance-status.partial {
            background: #ffc107;
            color: #212529;
        }
        
        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            border: 1px solid #e9ecef;
        }
        
        .chart-placeholder {
            background: #f8f9fa;
            border: 2px dashed #dee2e6;
            border-radius: 8px;
            padding: 40px;
            margin: 20px 0;
            text-align: center;
            color: #6c757d;
        }
        
        .recommendations {
            background: #e7f3ff;
            border-left: 5px solid #007bff;
            padding: 20px;
            margin: 30px 0;
            border-radius: 0 10px 10px 0;
        }
        
        .recommendations h4 {
            color: #007bff;
            margin-bottom: 15px;
            font-size: 1.3em;
        }
        
        .recommendations ul {
            list-style: none;
        }
        
        .recommendations li {
            margin: 10px 0;
            padding: 10px;
            background: white;
            border-radius: 5px;
            border-left: 3px solid #007bff;
        }
        
        .recommendations li:before {
            content: "ğŸ’¡";
            margin-right: 10px;
        }
        
        .footer {
            text-align: center;
            padding: 30px 0;
            border-top: 2px solid #e9ecef;
            margin-top: 50px;
            color: #6c757d;
        }
        
        .footer .timestamp {
            font-size: 0.9em;
            margin-top: 10px;
        }
        
        @media print {
            body {
                background-color: white;
            }
            
            .container {
                box-shadow: none;
                max-width: none;
                margin: 0;
                padding: 0;
            }
            
            .section {
                page-break-inside: avoid;
                box-shadow: none;
            }
            
            .toc {
                page-break-after: always;
            }
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .metadata {
                grid-template-columns: 1fr;
            }
            
            .overview-grid,
            .risk-grid,
            .compliance-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- æŠ¥å‘Šå¤´éƒ¨ -->
        <div class="header">
            <h1>{{ title }}</h1>
            <div class="subtitle">{{ subtitle or "ç»¼åˆåˆ†ææŠ¥å‘Š" }}</div>
            
            <div class="metadata">
                <div class="metadata-item">
                    <div class="label">é¡¹ç›®ID</div>
                    <div class="value">{{ project_id }}</div>
                </div>
                <div class="metadata-item">
                    <div class="label">æŠ¥å‘Šä½œè€…</div>
                    <div class="value">{{ author }}</div>
                </div>
                <div class="metadata-item">
                    <div class="label">æ‰€å±éƒ¨é—¨</div>
                    <div class="value">{{ department }}</div>
                </div>
                <div class="metadata-item">
                    <div class="label">ç”Ÿæˆæ—¶é—´</div>
                    <div class="value">{{ generated_at | format_datetime }}</div>
                </div>
            </div>
        </div>
        
        <!-- ç›®å½• -->
        <div class="toc">
            <h2>ğŸ“‹ ç›®å½•</h2>
            <ul>
                {% for section in sections %}
                <li><a href="#section-{{ section.id }}">{{ loop.index }}. {{ section.title }}</a></li>
                {% endfor %}
            </ul>
        </div>
        
        <!-- æŠ¥å‘Šç« èŠ‚ -->
        {% for section in sections %}
        <div class="section" id="section-{{ section.id }}">
            <h2>{{ loop.index }}. {{ section.title }}</h2>
            
            {% if section.id == 'executive_summary' %}
                <!-- æ‰§è¡Œæ‘˜è¦ -->
                <div class="overview-grid">
                    <div class="overview-card">
                        <h4>æ•´ä½“é£é™©ç­‰çº§</h4>
                        <div class="value">{{ data.overall_risk_level or "ä¸­ç­‰" }}</div>
                        <div class="description">åŸºäºå…¨é¢åˆ†æ</div>
                    </div>
                    <div class="overview-card">
                        <h4>åˆè§„è¯„åˆ†</h4>
                        <div class="value">{{ (data.compliance_score * 100) | round | int if data.compliance_score else 85 }}%</div>
                        <div class="description">åˆè§„æ€§æ£€æŸ¥ç»“æœ</div>
                    </div>
                    <div class="overview-card">
                        <h4>å‘ç°é—®é¢˜</h4>
                        <div class="value">{{ data.total_issues or 12 }}</div>
                        <div class="description">éœ€è¦å…³æ³¨çš„é—®é¢˜</div>
                    </div>
                    <div class="overview-card">
                        <h4>å»ºè®®æªæ–½</h4>
                        <div class="value">{{ data.recommendations | length if data.recommendations else 8 }}</div>
                        <div class="description">æ”¹è¿›å»ºè®®æ•°é‡</div>
                    </div>
                </div>
                
                <p>{{ section.content }}</p>
                
            {% elif section.id == 'risk_assessment' %}
                <!-- é£é™©è¯„ä¼° -->
                <p>{{ section.content }}</p>
                
                {% if section.charts %}
                <div class="chart-container">
                    <h4>é£é™©åˆ†å¸ƒå›¾è¡¨</h4>
                    {% for chart in section.charts %}
                    <div class="chart-placeholder">
                        <h5>{{ chart.title }}</h5>
                        <p>å›¾è¡¨ç±»å‹: {{ chart.type }}</p>
                        <p>{{ chart.description }}</p>
                    </div>
                    {% endfor %}
                </div>
                {% endif %}
                
                {% if data.risk_items %}
                <div class="risk-grid">
                    {% for risk in data.risk_items[:6] %}
                    <div class="risk-item">
                        <div class="risk-level {{ risk.severity | lower }}">{{ risk.severity }}é£é™©</div>
                        <h4>{{ risk.title }}</h4>
                        <p>{{ risk.description }}</p>
                        <p><strong>é£é™©åˆ†æ•°:</strong> {{ (risk.risk_score * 100) | round }}%</p>
                    </div>
                    {% endfor %}
                </div>
                {% endif %}
                
            {% elif section.id == 'compliance_check' %}
                <!-- åˆè§„æ£€æŸ¥ -->
                <p>{{ section.content }}</p>
                
                {% if data.compliance_items %}
                <div class="compliance-grid">
                    {% for item in data.compliance_items[:6] %}
                    <div class="compliance-item">
                        <div class="compliance-status {{ 'compliant' if item.status == 'åˆè§„' else 'non-compliant' if item.status == 'ä¸åˆè§„' else 'partial' }}">{{ item.status }}</div>
                        <h4>{{ item.standard }}</h4>
                        <p>{{ item.description }}</p>
                        {% if item.remediation_actions %}
                        <p><strong>å»ºè®®æªæ–½:</strong> {{ item.remediation_actions | join(', ') }}</p>
                        {% endif %}
                    </div>
                    {% endfor %}
                </div>
                {% endif %}
                
            {% else %}
                <!-- å…¶ä»–ç« èŠ‚ -->
                <p>{{ section.content }}</p>
                
                {% if section.charts %}
                <div class="chart-container">
                    {% for chart in section.charts %}
                    <div class="chart-placeholder">
                        <h5>{{ chart.title }}</h5>
                        <p>å›¾è¡¨ç±»å‹: {{ chart.type }}</p>
                        <p>{{ chart.description }}</p>
                    </div>
                    {% endfor %}
                </div>
                {% endif %}
            {% endif %}
        </div>
        {% endfor %}
        
        <!-- å»ºè®®æªæ–½ -->
        {% if data.recommendations %}
        <div class="recommendations">
            <h4>ğŸ¯ ä¸»è¦å»ºè®®æªæ–½</h4>
            <ul>
                {% for recommendation in data.recommendations %}
                <li>{{ recommendation }}</li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
        
        <!-- é¡µè„š -->
        <div class="footer">
            <p>æœ¬æŠ¥å‘Šç”±ç³»ç»Ÿè¯„å®¡æŠ€æœ¯å¹³å°æ™ºèƒ½ç”Ÿæˆ</p>
            <div class="timestamp">ç”Ÿæˆæ—¶é—´: {{ generated_at | format_datetime }}</div>
        </div>
    </div>
</body>
</html>