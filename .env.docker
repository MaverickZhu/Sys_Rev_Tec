# Docker 环境配置文件
# 用于 docker-compose 的环境变量配置

# =============================================================================
# 数据库配置
# =============================================================================
POSTGRES_DB=sys_rev_tech
POSTGRES_USER=postgres
POSTGRES_PASSWORD=sys_rev_secure_password_2024

# =============================================================================
# Redis 配置
# =============================================================================
REDIS_PASSWORD=redis_secure_password_2024

# =============================================================================
# 应用配置
# =============================================================================
APP_NAME=系统审查技术
APP_VERSION=1.0.0
ENVIRONMENT=production
DEBUG=false

# =============================================================================
# 安全配置
# =============================================================================
SECRET_KEY=your-super-secret-key-change-this-in-production-2024
JWT_SECRET_KEY=your-jwt-secret-key-change-this-in-production-2024
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# =============================================================================
# 服务端口配置
# =============================================================================
APP_PORT=8000
DB_PORT=5432
REDIS_PORT=6379
NGINX_HTTP_PORT=80
NGINX_HTTPS_PORT=443
PROMETHEUS_PORT=9090
GRAFANA_PORT=3000

# =============================================================================
# 监控配置
# =============================================================================
GRAFANA_PASSWORD=grafana_admin_password_2024
PROMETHEUS_RETENTION=200h

# =============================================================================
# 文件存储配置
# =============================================================================
UPLOAD_DIR=/app/uploads
STATIC_DIR=/app/static
LOG_DIR=/app/logs
BACKUP_DIR=/app/backups
TEMP_DIR=/app/temp

# =============================================================================
# OCR 配置
# =============================================================================
OCR_ENGINE=tesseract
OCR_LANGUAGE=chi_sim+eng
OCR_QUEUE_NAME=ocr_tasks
OCR_MAX_WORKERS=2

# =============================================================================
# 性能配置
# =============================================================================
UVICORN_WORKERS=4
UVICORN_MAX_REQUESTS=1000
UVICORN_MAX_REQUESTS_JITTER=100
GUNICORN_WORKERS=4
GUNICORN_WORKER_CLASS=uvicorn.workers.UvicornWorker
GUNICORN_WORKER_CONNECTIONS=1000
GUNICORN_MAX_REQUESTS=1000
GUNICORN_MAX_REQUESTS_JITTER=100
GUNICORN_TIMEOUT=120
GUNICORN_KEEPALIVE=5

# =============================================================================
# 日志配置
# =============================================================================
LOG_LEVEL=INFO
LOG_FORMAT=json
LOG_MAX_SIZE=104857600
LOG_BACKUP_COUNT=10

# =============================================================================
# CORS 配置
# =============================================================================
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8080,https://yourdomain.com
ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS
ALLOWED_HEADERS=*
ALLOW_CREDENTIALS=true

# =============================================================================
# 数据库连接池配置
# =============================================================================
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=30
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600

# =============================================================================
# Redis 连接配置
# =============================================================================
REDIS_MAX_CONNECTIONS=20
REDIS_RETRY_ON_TIMEOUT=true
REDIS_SOCKET_TIMEOUT=5
REDIS_SOCKET_CONNECT_TIMEOUT=5

# =============================================================================
# 文件上传配置
# =============================================================================
MAX_FILE_SIZE=104857600
ALLOWED_FILE_TYPES=pdf,doc,docx,txt,png,jpg,jpeg,gif,bmp,tiff

# =============================================================================
# 邮件配置 (可选)
# =============================================================================
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-password
SMTP_TLS=true
SMTP_SSL=false
EMAIL_FROM=your-email@gmail.com
EMAIL_FROM_NAME=系统审查技术

# =============================================================================
# SSL/TLS 配置
# =============================================================================
SSL_CERT_PATH=/etc/nginx/ssl/cert.pem
SSL_KEY_PATH=/etc/nginx/ssl/key.pem
SSL_DHPARAM_PATH=/etc/nginx/ssl/dhparam.pem

# =============================================================================
# 备份配置
# =============================================================================
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30
BACKUP_COMPRESSION=gzip

# =============================================================================
# 开发配置 (仅开发环境)
# =============================================================================
DEV_RELOAD=false
DEV_DEBUG_SQL=false
DEV_ENABLE_DOCS=false

# =============================================================================
# 监控和健康检查
# =============================================================================
HEALTH_CHECK_INTERVAL=30
HEALTH_CHECK_TIMEOUT=10
HEALTH_CHECK_RETRIES=3
METRICS_ENABLED=true
METRICS_PATH=/metrics

# =============================================================================
# 容器资源限制
# =============================================================================
APP_MEMORY_LIMIT=1G
APP_MEMORY_RESERVATION=512M
DB_MEMORY_LIMIT=2G
DB_MEMORY_RESERVATION=1G
REDIS_MEMORY_LIMIT=512M
REDIS_MEMORY_RESERVATION=256M
OCR_MEMORY_LIMIT=2G
OCR_MEMORY_RESERVATION=1G

# =============================================================================
# 网络配置
# =============================================================================
NETWORK_SUBNET=172.20.0.0/16
APP_IP=172.20.0.10
DB_IP=172.20.0.20
REDIS_IP=172.20.0.30
NGINX_IP=172.20.0.40

# =============================================================================
# 时区配置
# =============================================================================
TZ=Asia/Shanghai

# =============================================================================
# 注意事项
# =============================================================================
# 1. 请在生产环境中修改所有密码和密钥
# 2. 确保 SECRET_KEY 和 JWT_SECRET_KEY 是随机生成的强密钥
# 3. 根据实际需求调整资源限制和性能参数
# 4. 定期备份数据库和重要文件
# 5. 监控系统资源使用情况
# 6. 定期更新容器镜像以获取安全补丁